{% extends "base.html" %}
{% block title %}Verify Vote{% endblock %}

{% block content %}
<h2>Verify Your Vote</h2>

<form id="verify-form">
    <label>Election ID</label>
    <input type="text" id="election_id" required>

    <label>Receipt Hash</label>
    <input type="text" id="receipt_hash" required>

    <button type="submit">Verify</button>
</form>

<div id="result" style="margin-top: 1rem;"></div>

<script>
document.getElementById("verify-form").addEventListener("submit", async (e) => {
    e.preventDefault();

    const electionId = document.getElementById("election_id").value;
    const receiptHash = document.getElementById("receipt_hash").value;
    const resultEl = document.getElementById("result");

    resultEl.innerHTML = "üîç Verifying...";

    const res = await fetch("/verify-vote/check", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            election_id: electionId,
            receipt_hash: receiptHash
        })
    });

    const data = await res.json();

    if (data.valid) {
        resultEl.innerHTML = "‚úÖ " + (data.message || "Vote verified");
    } else {
        resultEl.innerHTML = "‚ùå " + (data.message || "Verification failed");
    }
});
</script>

{% endblock %}
