{% extends "base.html" %}
{% set title = "Cast Vote" %}

{% block content %}
<div class="vote-page">
    <h2>Cast Your Vote</h2>

    <form id="vote-form" method="POST" class="vote-form">
        <!-- =========================
             Election Selection
        ========================== -->
        <div class="form-group">
            <label for="election_id">Election</label>
            <select
    id="election_id"
    name="election_id"
    onchange="window.location='?election_id=' + this.value"
    required
>
    <option value="">Select Election</option>
    {% for election in elections %}
        <option value="{{ election.id }}"
            {% if election.id == selected_election_id %}selected{% endif %}
        >
            {{ election.election_name }}
        </option>
    {% endfor %}
</select>


        </div>

        <!-- =========================
             Vote Payload (Encrypted / Hashed)
        ========================== -->

   {% if candidates and candidates|length > 0 %}
<div class="form-group">
    <label>Your Choice</label>

    {% for candidate in candidates %}
        <label class="candidate-option">
            <input
                type="radio"
                name="vote_payload"
                value="{{ candidate.id }}"
                required
            >
            {{ candidate.full_name }} ({{ candidate.party_name }})
        </label>
    {% endfor %}
</div>
{% else %}
<p class="info-note">Select an election to view candidates.</p>
{% endif %}



        <button type="submit" class="btn-primary">
            Submit Vote
        </button>
    </form>

    <div class="vote-note">
        <p>
            Your vote will be securely recorded on the blockchain.
            You will receive a transaction ID after submission.
        </p>
    </div>
</div>

<!-- =========================
     Vote JS
========================= -->
<script src="{{ url_for('static', filename='js/vote.js') }}"></script>

{% endblock %}
